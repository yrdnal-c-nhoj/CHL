import puppeteer from 'puppeteer';
import fs from 'fs';
import path from 'path';
import { fileURLToPath } from 'url';

const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);

// Make sure screenshots folder exists
const screenshotsDir = path.join(__dirname, 'screenshots');
if (!fs.existsSync(screenshotsDir)) {
  fs.mkdirSync(screenshotsDir);
}

// --- Explicit date list ---
const slugs = [
  '25-04-01','25-04-02','25-04-03','25-04-04','25-04-05','25-04-06','25-04-07',
  '25-04-08','25-04-09','25-04-10','25-04-11','25-04-12','25-04-13','25-04-14',
  '25-04-15','25-04-16','25-04-17','25-04-18','25-04-19','25-04-20','25-04-21',
  '25-04-22','25-04-23','25-04-24','25-04-25','25-04-26','25-04-27','25-04-28',
  '25-04-29','25-04-30','25-05-01','25-05-02','25-05-03','25-05-04','25-05-05',
  '25-05-06','25-05-07','25-05-08','25-05-09','25-05-10','25-05-11','25-05-12',
  '25-05-13','25-05-14','25-05-15','25-05-16','25-05-17','25-05-18','25-05-19',
  '25-05-20','25-05-21','25-05-22','25-05-23','25-05-24','25-05-25','25-05-26',
  '25-05-27','25-05-28','25-05-29','25-05-30','25-05-31','25-06-01','25-06-02',
  '25-06-03','25-06-04','25-06-05','25-06-06','25-06-07','25-06-08','25-06-09',
  '25-06-10','25-06-11','25-06-12','25-06-13','25-06-14','25-06-15','25-06-16',
  '25-06-17','25-06-18','25-06-19','25-06-20','25-06-21','25-06-22','25-06-23',
  '25-06-24','25-06-25','25-06-26','25-06-27','25-06-28','25-06-29','25-06-30',
  '25-07-01','25-07-02','25-07-03','25-07-04','25-07-05','25-07-06','25-07-07',
  '25-07-08','25-07-09','25-07-10','25-07-11','25-07-12','25-07-13','25-07-14',
  '25-07-15','25-07-16','25-07-17','25-07-18','25-07-19','25-07-20','25-07-21',
  '25-07-22','25-07-23','25-07-24','25-07-25','25-07-26','25-07-27','25-07-28',
  '25-07-29','25-07-30','25-07-31','25-08-01','25-08-02','25-08-03','25-08-04',
  '25-08-05','25-08-06','25-08-07','25-08-08','25-08-09','25-08-10','25-08-11',
  '25-08-12','25-08-13','25-08-14','25-08-15','25-08-16','25-08-17','25-08-18',
  '25-08-19','25-08-20','25-08-21','25-08-22','25-08-23','25-08-24','25-08-25',
  '25-08-26','25-08-27','25-08-28','25-08-29','25-08-30','25-08-31','25-09-01',
  '25-09-02','25-09-03','25-09-04','25-09-05'
];

const urls = slugs.map(slug => `https://www.cubistheart.com/${slug}`);

const browser = await puppeteer.launch({ headless: true });

for (const url of urls) {
  console.log(`Capturing ${url}...`);

  const slug = url.split('/').pop();
  const filePath = path.join(screenshotsDir, `${slug}.png`);

  const page = await browser.newPage();
  await page.goto(url, { waitUntil: 'networkidle2', timeout: 30000 });

  // Wait 17s after load
  await new Promise(resolve => setTimeout(resolve, 17000));

  await page.screenshot({ path: filePath, fullPage: true });
  await page.close();

  console.log(`Saved: ${filePath}`);

  // Wait 17s before the next page
  await new Promise(resolve => setTimeout(resolve, 17000));
}

await browser.close();
